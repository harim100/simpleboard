<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="mssql.mybatis.boardMapper">
<insert id="boardInsert"  parameterType="com.board.dto.BoardDto">
	INSERT INTO Bd_Board
	(
		Title
		,Content
		,ImagePath
		,CustomerNum
	)
	VALUES 
	( 
		#{title}
		,#{content}
		<choose>
			<when test="imagePath!=null">
				,#{imagePath}
			</when>
			<otherwise>
				,DEFAULT
			</otherwise>
		</choose>
		,#{customerNum}
	)
</insert>

<select id="boardList" parameterType="int" resultType="com.board.dto.BoardDto">
	SELECT 
		BrdIdx
		,Title
		,Content
		,ImagePath
		,CONVERT(varchar(10), InsDate, 23) AS InsDate
		,UseYN
		,CONVERT(varchar(10), UpdateDate, 23) AS UpdateDate
		,CustomerNum
	FROM  Bd_Board WITH(NOLOCK)
	ORDER BY BrdIdx desc
	OFFSET #{offset} ROWS
	FETCH NEXT 5 ROWS ONLY
</select>

<select id="boardSelect" resultType="com.board.dto.BoardDto">
	SELECT
		BrdIdx
		,Title
		,Content
		,ImagePath
		,CONVERT(varchar(10), InsDate, 23) AS InsDate
		,CONVERT(varchar(10), UpdateDate, 23) AS UpdateDate
		,CustomerNum
	FROM Bd_Board WITH(NOLOCK)
	WHERE BrdIdx = #{brdIdx}
</select>

<delete id="boardDelete" parameterType="int">
	DELETE FROM Bd_Board
	WHERE BrdIdx = #{brdIdx}
</delete>

<delete id="boardDeleteGroup" parameterType="java.util.ArrayList">
	DELETE FROM Bd_Board
	WHERE BrdIdx in 
	<foreach collection="array" item='item' index='i' open="(" close=")" separator=","> 
		#{item}
	</foreach>
</delete>

<update id="boardUpdate" parameterType="com.board.dto.BoardDto">
	UPDATE Bd_Board
	SET  
		Title = #{title}
		,Content = #{content}
		,ImagePath = #{imagePath}
		,UpdateDate = getDate()
	WHERE BrdIdx = #{brdIdx}
</update>

<select id="getTotal" parameterType="map" resultType="Integer">
	SELECT count(BrdIdx) 
	FROM Bd_Board WITH(NOLOCK)
	WHERE UseYN = 'Y';
</select>

</mapper>