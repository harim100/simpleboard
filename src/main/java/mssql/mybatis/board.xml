<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="mssql.mybatis.firstBMapper">
<insert id="boardInsert"  parameterType="map">
	INSERT INTO Bd_Board
	           (Title
	           ,Content
	           ,ImagePath
	           ,InsDate
	           ,IsUse
	           ,CustomerNum
	           )
	VALUES ( 
		 #{title}
		,#{content}
		,#{imagePath}
		, getdate()
		,'Y'
		,#{customerNum}
	 	)
</insert>

<select id="boardList" parameterType="map" resultType="map">
	SELECT ROW_NUMBER() OVER(ORDER BY BrdIdx DESC) AS RowNumber
			,BrdIdx
			,Title
			,Content
			,ImagePath
			,CONVERT(varchar(10), InsDate, 23) AS InsDate
			,IsUse
			,CONVERT(varchar(10), UpdateDate, 23) AS UpdateDate
			,CustomerNum
	FROM  Bd_Board
	ORDER BY BrdIdx desc
	OFFSET #{offset} ROWS
	FETCH NEXT 5 ROWS ONLY
</select>

<select id="boardSelect" resultType="com.board.vo.BoardVO">
	SELECT
		BrdIdx
		,Title
		,Content
		,ImagePath
		,CONVERT(varchar(10), InsDate, 23) AS InsDate
		,CONVERT(varchar(10), UpdateDate, 23) AS UpdateDate
		,CustomerNum
	FROM Bd_Board
	WHERE BrdIdx = #{idx}
</select>

<delete id="boardDelete" parameterType="map">
	DELETE FROM Bd_Board
	WHERE BrdIdx = #{idx}
</delete>

<delete id="boardDeleteGroup" parameterType="map">
	DELETE FROM Bd_Board
	WHERE BrdIdx in 
	<foreach collection="array" item='item' index='i' open="(" close=")" separator=","> 
	#{item}
	</foreach>
</delete>

<update id="boardUpdate" parameterType="map">
	UPDATE Bd_Board
	SET  Title = #{title}
		,Content = #{content}
		,ImagePath = #{imagePath}
		,UpdateDate = getDate()
	WHERE BrdIdx = #{idx}

</update>

<select id="getTotal" parameterType="map" resultType="Integer">
	SELECT count(BrdIdx) FROM Bd_Board WHERE IsUse = 'Y';
</select>

</mapper>